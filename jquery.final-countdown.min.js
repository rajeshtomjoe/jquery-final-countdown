!function(e){var o,r,s;e.fn.final_countdown=function(n,a){if(r=e(this),r.is(":visible")){var d=e.extend({start:void 0,end:void 0,now:void 0,selectors:{value_seconds:".clock-seconds .val",canvas_seconds:"canvas-seconds",value_minutes:".clock-minutes .val",canvas_minutes:"canvas-minutes",value_hours:".clock-hours .val",canvas_hours:"canvas-hours",value_days:".clock-days .val",canvas_days:"canvas-days"},seconds:{borderColor:"#7995D5",borderWidth:"6"},minutes:{borderColor:"#ACC742",borderWidth:"6"},hours:{borderColor:"#ECEFCB",borderWidth:"6"},days:{borderColor:"#FF9900",borderWidth:"6"}},n);o=e.extend({},d,n),void 0===o.start&&(o.start=r.data("start")),void 0===o.end&&(o.end=r.data("end")),void 0===o.now&&(o.now=r.data("now")),r.data("border-color")&&(o.seconds.borderColor=o.minutes.borderColor=o.hours.borderColor=o.days.borderColor=r.data("border-color")),o.now<o.start&&(o.start=o.now,o.end=o.now),o.now>o.end&&(o.start=o.now,o.end=o.now),"function"==typeof a&&(s=a);var i=new t;i.setSettings(o),i.responsive(),i.dispatchTimer(),i.prepareCounters(),i.startCounters()}};var t=function(){var o,r,t,n,a,d,i,c,h,u,l=function(){e(window).load(w),e(window).on("redraw",function(){switched=!1,w()}),e(window).on("resize",w)},w=function(){d.draw(),i.draw(),c.draw(),h.draw()},v=function(e){return Math.PI/180*e-Math.PI/180*90},f=function(){o={total:Math.floor((u.end-u.start)/86400),days:Math.floor((u.end-u.now)/86400),hours:24-Math.floor((u.end-u.now)%86400/3600),minutes:60-Math.floor((u.end-u.now)%86400%3600/60),seconds:60-Math.floor((u.end-u.now)%86400%3600%60)}},b=function(){var s=e("#"+u.selectors.canvas_seconds).width(),l=new Kinetic.Stage({container:u.selectors.canvas_seconds,width:s,height:s});r=new Kinetic.Shape({drawFunc:function(r){var s=e("#"+u.selectors.canvas_seconds).width(),t=s/2-u.seconds.borderWidth/2,n=s/2,a=s/2;r.beginPath(),r.arc(n,a,t,v(0),v(6*o.seconds)),r.fillStrokeShape(this),e(u.selectors.value_seconds).html(60-o.seconds)},stroke:u.seconds.borderColor,strokeWidth:u.seconds.borderWidth}),d=new Kinetic.Layer,d.add(r),l.add(d);var w=e("#"+u.selectors.canvas_minutes).width(),f=new Kinetic.Stage({container:u.selectors.canvas_minutes,width:w,height:w});t=new Kinetic.Shape({drawFunc:function(r){var s=e("#"+u.selectors.canvas_minutes).width(),t=s/2-u.minutes.borderWidth/2,n=s/2,a=s/2;r.beginPath(),r.arc(n,a,t,v(0),v(6*o.minutes)),r.fillStrokeShape(this),e(u.selectors.value_minutes).html(60-o.minutes)},stroke:u.minutes.borderColor,strokeWidth:u.minutes.borderWidth}),i=new Kinetic.Layer,i.add(t),f.add(i);var b=e("#"+u.selectors.canvas_hours).width(),m=new Kinetic.Stage({container:u.selectors.canvas_hours,width:b,height:b});n=new Kinetic.Shape({drawFunc:function(r){var s=e("#"+u.selectors.canvas_hours).width(),t=s/2-u.hours.borderWidth/2,n=s/2,a=s/2;r.beginPath(),r.arc(n,a,t,v(0),v(360*o.hours/24)),r.fillStrokeShape(this),e(u.selectors.value_hours).html(24-o.hours)},stroke:u.hours.borderColor,strokeWidth:u.hours.borderWidth}),c=new Kinetic.Layer,c.add(n),m.add(c);var y=e("#"+u.selectors.canvas_days).width(),_=new Kinetic.Stage({container:u.selectors.canvas_days,width:y,height:y});a=new Kinetic.Shape({drawFunc:function(r){var s=e("#"+u.selectors.canvas_days).width(),t=s/2-u.days.borderWidth/2,n=s/2,a=s/2;r.beginPath(),0==o.total?r.arc(n,a,t,v(0),v(360)):r.arc(n,a,t,v(0),v(360/o.total*(o.total-o.days))),r.fillStrokeShape(this),e(u.selectors.value_days).html(o.days)},stroke:u.days.borderColor,strokeWidth:u.days.borderWidth}),h=new Kinetic.Layer,h.add(a),_.add(h)},m=function(){var e=setInterval(function(){if(o.seconds>59){if(60-o.minutes==0&&24-o.hours==0&&0==o.days)return clearInterval(e),void(void 0!==s&&s.call(this));o.seconds=1,o.minutes>59?(o.minutes=1,i.draw(),o.hours>23?(o.hours=1,o.days>0&&(o.days--,h.draw())):o.hours++,c.draw()):o.minutes++,i.draw()}else o.seconds++;d.draw()},1e3)},y=function(e){u=e};return{responsive:l,dispatchTimer:f,prepareCounters:b,startCounters:m,setSettings:y}}}(jQuery);